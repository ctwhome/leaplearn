<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Leap Learn - Gestures</title>
    <meta name="author" content="Jesus Garcia Gonzalez - www.ctwhome.com">
    <meta name="description" content="">

    <!--<meta name="viewport" content="width=device-width, initial-scale=1">-->
    <meta name="viewport" content="initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,width=device-width,user-scalable=no"/>

    <link rel="stylesheet" href="assets/css/style.css">
    <script data-main="assets/js/TNA/TNA.js" src="assets/js/lib/require-2.1.5/require.min.js"></script>



    <!--LEAP MOTION EXAMPLE-->
    <script src="//cdnjs.cloudflare.com/ajax/libs/three.js/r67/three.js"></script>
    <script src="//js.leapmotion.com/leap-0.6.0.min.js"></script>
    <script src="//js.leapmotion.com/leap-plugins-0.1.6.min.js"></script>
    <script src="//js.leapmotion.com/leap.rigged-hand-0.1.4.min.js"></script>
</head>
<body id="app">


<!--Main content-->
<section id="dashboard" >

        <input type="button" class="btn" value="click to go fullscreen" onclick="requestFullScreen()">

    <script>
//        function requestFullScreen() {
//
//            var el = document.body;
//
//            // Supports most browsers and their versions.
//            var requestMethod = el.requestFullScreen || el.webkitRequestFullScreen
//                    || el.mozRequestFullScreen || el.msRequestFullScreen;
//
//            if (requestMethod) {
//
//                // Native full screen.
//                requestMethod.call(el);
//
//            } else if (typeof window.ActiveXObject !== "undefined") {
//
//                // Older IE.
//                var wscript = new ActiveXObject("WScript.Shell");
//
//                if (wscript !== null) {
//                    wscript.SendKeys("{F11}");
//                }
//            }
//        }


    </script>


        <script>
            var baseBoneRotation = (new THREE.Quaternion).setFromEuler(
                    new THREE.Euler(Math.PI / 2, 0, 0)
            );

            Leap.loop({background: true}, {
                hand: function (hand) {

                    hand.fingers.forEach(function (finger) {

                        // This is the meat of the example - Positioning `the cylinders on every frame:
                        finger.data('boneMeshes').forEach(function(mesh, i){
                            var bone = finger.bones[i];

                            mesh.position.fromArray(bone.center());

                            mesh.setRotationFromMatrix(
                                    (new THREE.Matrix4).fromArray( bone.matrix() )
                            );

                            mesh.quaternion.multiply(baseBoneRotation);
                        });

                        finger.data('jointMeshes').forEach(function(mesh, i){
                            var bone = finger.bones[i];

                            if (bone) {
                                mesh.position.fromArray(bone.prevJoint);
                            }else{
                                // special case for the finger tip joint sphere:
                                bone = finger.bones[i-1];
                                mesh.position.fromArray(bone.nextJoint);
                            }

                        });

                    });

                    renderer.render(scene, camera);

                }})
                // these two LeapJS plugins, handHold and handEntry are available from leapjs-plugins, included above.
                // handHold provides hand.data
                // handEntry provides handFound/handLost events.
                    .use('handHold')
                    .use('handEntry')
                    .on('handFound', function(hand){

                        hand.fingers.forEach(function (finger) {

                            var boneMeshes = [];
                            var jointMeshes = [];

                            finger.bones.forEach(function(bone) {

                                // create joints

                                // CylinderGeometry(radiusTop, radiusBottom, height, radiusSegments, heightSegments, openEnded)
                                var boneMesh = new THREE.Mesh(
                                        new THREE.CylinderGeometry(5, 5, bone.length),
                                        new THREE.MeshPhongMaterial()
                                );

                                boneMesh.material.color.setHex(0xffffff);
                                scene.add(boneMesh);
                                boneMeshes.push(boneMesh);
                            });

                            for (var i = 0; i < finger.bones.length + 1; i++) {

                                var jointMesh = new THREE.Mesh(
                                        new THREE.SphereGeometry(8),
                                        new THREE.MeshPhongMaterial()
                                );

                                jointMesh.material.color.setHex(0x0088ce);
                                scene.add(jointMesh);
                                jointMeshes.push(jointMesh);

                            }


                            finger.data('boneMeshes', boneMeshes);
                            finger.data('jointMeshes', jointMeshes);

                        });

                    })
                    .on('handLost', function(hand){

                        hand.fingers.forEach(function (finger) {

                            var boneMeshes = finger.data('boneMeshes');
                            var jointMeshes = finger.data('jointMeshes');

                            boneMeshes.forEach(function(mesh){
                                scene.remove(mesh);
                            });

                            jointMeshes.forEach(function(mesh){
                                scene.remove(mesh);
                            });

                            finger.data({
                                boneMeshes: null,
                                boneMeshes: null
                            });

                        });

                        renderer.render(scene, camera);

                    })
                    .use('playback', {
                        // This is a compressed JSON file of preprecorded frame data
                        recording: './scroll-and-swipe-100fps.json.lz',
                        // How long, in ms, between repeating the recording.
                        timeBetweenLoops: 2000,
                        pauseOnHand: true
                    })
                    .connect();


            // all units in mm
            var initScene = function () {
                window.scene = new THREE.Scene();
                window.renderer = new THREE.WebGLRenderer({
                    alpha: true
                });

                window.renderer.setClearColor(0x000000, 0);
                window.renderer.setSize(window.innerWidth, window.innerHeight);

                window.renderer.domElement.style.position = 'fixed';
                window.renderer.domElement.style.top = 0;
                window.renderer.domElement.style.left = 0;
                window.renderer.domElement.style.width = '100%';
                window.renderer.domElement.style.height = '100%';

                document.body.appendChild(window.renderer.domElement);

                var directionalLight = new THREE.DirectionalLight( 0xffffff, 1 );
                directionalLight.position.set( 0, 0.5, 1 );
                window.scene.add(directionalLight);

                window.camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 1000);
                window.camera.position.fromArray([0, 150, 700]);
                window.camera.lookAt(new THREE.Vector3(0, 160, 0));

                window.addEventListener('resize', function () {

                    camera.aspect = window.innerWidth / window.innerHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(window.innerWidth, window.innerHeight);
                    renderer.render(scene, camera);

                }, false);

                scene.add(camera);


                renderer.render(scene, camera);
            };

            initScene();
        </script>




</section>

</body>
</html>