(function(){"use strict";window.Vector=function(){function e(e,t){this.x=e!=null?e:0,this.y=t!=null?t:0}return e.prototype.dist=function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},e.prototype.add=function(t){return t instanceof e?(this.x+=t.x,this.y+=t.y):(this.x+=t,this.y+=t),this},e.prototype.div=function(t){return t instanceof e?(this.x/=t.x,this.y/=t.y):(this.x/=t,this.y/=t),this},e.prototype.mult=function(t){return t instanceof e?(this.x*=t.x,this.y*=t.y):(this.x*=t,this.y*=t),this},e}(),window.OneDollar=function(){function e(e,t,n,r,i){e==null&&(e=80),t==null&&(t=64),n==null&&(n=250),r==null&&(r=45),i==null&&(i=2),this.VERSION="1.1.0",this.config={score:e},this.MATH={PHI:.5*(-1+Math.sqrt(5)),HALFDIAGONAL:.5*Math.sqrt(n*n+n*n)},this.ALGO={parts:t,size:n,angle:r,step:i},this.temps={},this.binds={},this.cands=[]}return e.prototype.add=function(e,t){return t.length>0&&(this.temps[e]=this._transform(t)),this},e.prototype.remove=function(e){return this.temps[e]!==void 0&&delete this.temps[e],this},e.prototype.on=function(e,t){var n,r,i;n=e.split(" ");for(r=0,i=n.length;r<i;r++)e=n[r],this.temps[e]!==void 0&&(this.binds[e]=t);return this},e.prototype.off=function(e){return this.binds[e]!==void 0&&delete this.binds[e],this},e.prototype.check=function(e){var t,n,r,i,s,o,u,a,f;s=e;if(e.length>0){e=this._transform(e),n=+Infinity,u=null,i=[],f=this.temps;for(r in f)a=f[r],this.binds[r]!==void 0&&(o=this.__find_best_template(e,a),o<n&&(n=o,u=r),i.push({name:r,score:parseFloat(((1-o/this.MATH.HALFDIAGONAL)*100).toFixed(2))}));if(u!==null){i.sort(function(e,t){return e.score<t.score?1:-1});if(i[0].score>=this.config.score)return t={name:i[0].name,score:i[0].score,path:{start:new Vector(s[0][0],s[0][1]),end:new Vector(s[s.length-1][0],s[s.length-1][1]),centroid:this.___get_centroid(this.__convert(s))},ranking:i},this.binds[u].apply(this,[t]),t}return!1}return!1},e.prototype.start=function(e,t){return this.cands[e]=[],this.cands[e].push(t)},e.prototype.update=function(e,t){return this.cands[e].push(t)},e.prototype.end=function(e,t){return this.cands[e].push(t),this.check(this.cands[e]),delete this.cands[e]},e.prototype._transform=function(e){return e=this.__convert(e),e=this.__resample(e),e=this.__rotate_to_zero(e),e=this.__scale_to_square(e),e=this.__translate_to_origin(e),e},e.prototype.__convert=function(e){var t,n,r,i;n=[];for(r=0,i=e.length;r<i;r++)t=e[r],n.push(new Vector(t[0],t[1]));return n},e.prototype.__resample=function(e){var t,n,r,i,s,o,u,a,f,l,c;o=this.___get_length(e)/(this.ALGO.parts-1),t=0,s=[];while(e.length!==0){i=e.pop();if(s.length===0)s.push(i);else{if(e.length===0){s.push(i);break}r=e[e.length-1],u=i.dist(r);if(t+u>=o){a=new Vector(i.x+(o-t)/u*(r.x-i.x),i.y+(o-t)/u*(r.y-i.y)),s.push(a),e.push(a),t=0;if(s.length===this.ALGO.parts-1){s.push(e[e.length-1]);break}}else t+=u}}if(s.length!==this.ALGO.parts){r=s[s.length-1];for(n=f=l=s.length,c=this.ALGO.parts;l<=c?f<c:f>c;n=l<=c?++f:--f)s.push(r)}return s},e.prototype.__rotate_to_zero=function(e){var t,n;return t=this.___get_centroid(e),n=Math.atan2(t.y-e[0].y,t.x-e[0].x),this.___rotate(e,-n,t)},e.prototype.__scale_to_square=function(e){var t,n,r,i,s,o,u;t=n=-Infinity,r=i=+Infinity;for(o=0,u=e.length;o<u;o++)s=e[o],r=Math.min(s.x,r),t=Math.max(s.x,t),i=Math.min(s.y,i),n=Math.max(s.y,n);return this.___scale(e,new Vector(this.ALGO.size/(t-r),this.ALGO.size/(n-i)))},e.prototype.__translate_to_origin=function(e){var t;return t=this.___get_centroid(e),this.___translate(e,t.mult(-1))},e.prototype.__find_best_template=function(e,t){var n,r,i,s,o,u,a;n=this.___radians(-this.ALGO.angle),r=this.___radians(this.ALGO.angle),a=this.___radians(this.ALGO.step),i=(1-this.MATH.PHI)*r+this.MATH.PHI*n,s=(1-this.MATH.PHI)*n+this.MATH.PHI*r,o=this.___get_difference_at_angle(e,t,i),u=this.___get_difference_at_angle(e,t,s);if(o!==+Infinity&&u!==+Infinity){while(Math.abs(r-n)>a)o<u?(r=s,s=i,u=o,i=this.MATH.PHI*n+(1-this.MATH.PHI)*r,o=this.___get_difference_at_angle(e,t,i)):(n=i,i=s,o=u,s=this.MATH.PHI*r+(1-this.MATH.PHI)*n,u=this.___get_difference_at_angle(e,t,s));return Math.min(o,u)}return+Infinity},e.prototype.___get_centroid=function(e){var t,n,r,i;t=new Vector;for(r=0,i=e.length;r<i;r++)n=e[r],t.add(n);return t.div(e.length),t},e.prototype.___get_length=function(e){var t,n,r,i,s;t=0,r=null;for(i=0,s=e.length;i<s;i++)n=e[i],r!==null&&(t+=n.dist(r)),r=n;return t},e.prototype.___get_difference_at_angle=function(e,t,n){var r;return r=this.___get_centroid(e),e=this.___rotate(e,n,r),this.___get_difference(e,t)},e.prototype.___get_difference=function(e,t){var n,r,i,s,o;n=0;for(r=s=0,o=e.length;s<o;r=++s)i=e[r],n+=i.dist(t[r]);return n/e.length},e.prototype.___translate=function(e,t){var n,r,i;for(r=0,i=e.length;r<i;r++)n=e[r],n.add(t);return e},e.prototype.___scale=function(e,t){var n,r,i;for(r=0,i=e.length;r<i;r++)n=e[r],n.mult(t);return e},e.prototype.___rotate=function(e,t,n){var r,i,s,o,u,a,f,l;o=Math.sin(t),r=Math.cos(t);for(i=f=0,l=e.length;f<l;i=++f)s=e[i],u=(s.x-n.x)*r-(s.y-n.y)*o+n.x,a=(s.x-n.x)*o+(s.y-n.y)*r+n.y,e[i]=new Vector(u,a);return e},e.prototype.___radians=function(e){return e*Math.PI/180},e}()}).call(this);